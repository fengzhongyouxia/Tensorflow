
```python
'''
实现变量的收集 将所有变量存储在一个集合中
用途：
1、保存变量
2、迁移学习[如：提取所有变量，排除掉最后一层的变量参数（重新初始化）]
'''

import tensorflow as tf

c_names=['eval_net_params', tf.GraphKeys.GLOBAL_VARIABLES]

w_initializer, b_initializer = \
                tf.random_normal_initializer(0., 0.3), tf.constant_initializer(0.1)  # config of layers
with tf.variable_scope('l1'):
    w1 = tf.get_variable('w1', [4, 2], initializer=w_initializer, collections=c_names)
    b1 = tf.get_variable('b1', [2], initializer=b_initializer,
                         collections=c_names)  # 将变量b1 放入c_names中 通过tf.get_collection('eval_net_params')获取变量集合
    # l1 = tf.nn.relu(tf.matmul(self.s, w1) + b1)

with tf.variable_scope('l2'):
    w2 = tf.get_variable('w2', [2, 1], initializer=w_initializer, collections=c_names)
    b2 = tf.get_variable('b2', [1], initializer=b_initializer,
                         collections=c_names)  # 将变量b1 放入c_names中 通过tf.get_collection('eval_net_params')获取变量集合

sess=tf.InteractiveSession()
tf.global_variables_initializer().run()

e_params = tf.get_collection('eval_net_params') # 得到eval_net scope下的所有变量
print(e_params) # [<tf.Variable 'l1/w1:0' shape=(4, 2) dtype=float32_ref>, <tf.Variable 'l1/b1:0' shape=(2,) dtype=float32_ref>]
for variable in e_params:
    print(variable.eval())

last_params=[]
for variable in e_params: 
    if 'l2' in variable.name:
        last_params.append(variable)
print(last_params)
sess.run(tf.variables_initializer(last_params)) # 重新初始化'l2' scope的所有变量




```
